<%* 
// --- 1. 初始化日期与核心变量 ---
// 获取当前文件对应的日期
let currentDate = moment(tp.file.title, "YYYY-MM-DD", true);
if (!currentDate.isValid()) {
    currentDate = moment();
}

// 获取显示的日期标题 (例如: Monday)
let titleDate = currentDate.format("dddd");

// --- 2. 计算周计划文件路径 ---
// 逻辑: 总是使用本周一所在的月份和日期来确定文件名
// 例如: 如果今天是周三(2月1日)，本周一(1月30日)，则文件名为 ...2025-01-W05
let mondayDate = currentDate.clone().isoWeekday(1);
let weekFileName = mondayDate.format("YYYY-MM-[W]WW");
let weeklyPlanPath = `weekly_plan/${weekFileName}`;

// --- 3. 尝试读取周计划内容 ---
let dayAbbr = currentDate.clone().locale('en').format("ddd"); // 强制英文 (Mon, Tue)
let planContent = "";
let tFile = tp.file.find_tfile(weeklyPlanPath);

if (tFile) {
    const fileContent = await app.vault.read(tFile);
    // 匹配格式: - **Mon:** 计划内容
    const regex = new RegExp(`-\s*\*\*${dayAbbr}:\*\*\s*(.*)`, "i");
    const match = fileContent.match(regex);
    if (match && match[1].trim()) {
        planContent = match[1].trim();
    }
}
%> 
# <% titleDate %>

🔗 **关联**: [[<% weeklyPlanPath %>|📅 本周计划 (<% weekFileName %>)]]

# 今日计划
<% planContent ? `> 📌 **周计划**: ${planContent}` : `> ℹ️ *今日暂无周计划内容 (关联文件: ${weekFileName})*` %>

## 💻 CS 学习与开发
- 
## ✅ 待办事项
- [ ] 跑步打卡
- [ ] 背单词打卡
- 作业
	- [ ] 作业1
	- [ ] 作业2
	- [ ] --
- [ ] 
## 📝 笔记与想法
###